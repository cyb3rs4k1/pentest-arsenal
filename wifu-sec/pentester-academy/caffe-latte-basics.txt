mesasge injection attacks
	- No replay protection
	- Aireplay-ng arp replay

Message injection
	- ChopChop attack
	- Cafe latte attack
	- Fragmentation attack
	- Hirte attack

WEP has a flaw which allows message modification.
Original research paper : Intercepting mobile communications 802.11

CRC-32 is a lineat function of the message, hence the checksum is distributive over XOR
Thus we can tamper arbitary byte locations in the packet and patch the checksum
This will be a valid packet accepted by the access point

IV 		Data			ICV
4		>=1			4
|					|
v					v

Encrypted Data				Enc.ICV

Data 					ICV

		XOR


	RC4 Keystream


Just bit mask created for the notes: Attacker modifications

ICV Patch = CRC-32 of Attacker Modifications





Encrypted Data				Enc.ICV

Data 					ICV

		XOR

Attacker modifications			ICV Patch

||

Modified Encrypted data			ICV
(Valid Encrypted data)






Data					ICV

		XOR

	RC4 Keystream


		xor(the above)

Attacker Modifications			ICV Patch


A(xor)B(xor)C = [A(xor)C](xor)B




Modified packet with XOR with Keystream :




Data					ICV

		XOR
				
Attacker Modifications			ICV Patch

			||

Modified Data 				Corrected ICV

			XOR(Xor the above)


		RC4 Keystream

			||

	Modified Encrypted Data		Enc.ICV

		(Valid Encrypted Packet!)


Repercussions:

We can modify arbitrary data in a WEP packet and patch the ICV

This is a valid WEP packet which will be accepted by the Access Point/client

Caffe Latte attack Modifies a Gratuitous ARP packet to change it to a ARP Request Packet for the same host!

Host Replies and we can collect these packet to crack the WEP packet.



Caffe-latte is a far away client hotspot hack method

Observation 1 : 

Can we somehow have an isolated Client generate WEP encrypted data packets using the authorized network's key?

Windows caches the WEP key of networks in its PNL

To crack WEP all we need is encrypted data packets

Observation 2 :

Can you force a WEP client connect to a honey pot without having knowledge of the key

ifconfig -a

airodump-ng --channel 1 wlan0mon

Connect client.

airbase-ng -W 1 --essid <essid> -c 1 wlan0mon

Look at wireshark, check the authentication, the alfa card sends fake auth and the victim sends the original wep key and alfa sends fake successful and got the key.




















