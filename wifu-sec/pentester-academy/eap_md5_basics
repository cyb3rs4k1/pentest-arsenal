EAP MD5

From Client to AP :

AP sends EAP request identity
EAP Response identity - Client to AP
EAP Request MD5 Challenge - AP to Client
EAP Response MD5 Challenge - Client to AP
EAP Success - AP to Client

Meanwhile in AP and RADIUS:

RADIUS Access Request - AP to RADIUS(During EAP Identity response)
RADIUS Access Challenge - RADIUS to AP(EAP Request MD5 Challenge)
RADIUS Access Request - AP to RADIUS(EAP Response MD5 Challenge)
RADIUS Access Accept - RADIUS to AP(EAP Success)

Setting up the RADIUS Server
Add a username/pass in users file
Make eap-md5 the default EAP type in eap.conf
Ensure the shared secret is correct for the AP-RADIUS server in clients.conf

Backup file :
cd /usr/local/etc/raddb
cp users users.original

vim users
Add a line :
SecurityTube	Cleartext-Password := "demo12345"

Backup eapconffile :
cp eap.conf eap.conf.original

vim eap.conf 

In the eap {, change it to md5 instead of PEAP.

Configuration will be in clients.conf

Objective of LAB :
Observe traffic on wired side between AP and RADIUS
Observe traffic on wireless side between Client and AP

ifconfig

raidusd -s -X (To start the radius server)

Now start two instances of wireshark :
Filter for 'eap' packets.

ifconfig -a

airodump-ng wlan0mon

iwconfig wlan0mon channel 1

wireshark &

Sniff on wlan0mon interface

Filter for 'eap' packets.

Change the network setting in your system to MD5. ( Its removed now in windows)

Now if you connect to the wifi, it will ask for an authentication system.

In the wireshark, look for radius protocol and look for EAP. In the value, the challenge will be there. Look closely with this challenge for the 4 packets.



