WPA/WPA2 Enterprise

EAP Type 	Real World Usage
PEAP		Highest
EAP-TTLS	High
EAP-TLS		Medium
LEAP		Low
EAP-FAST	Low


PEAP
Protected Extensible Authenticaiton Protocol
Typical Usage:
	PEAPv0 with EAP-MSCHAPv2(most popular)
		Native support on windows
	PEAPv1 with EAP-GTC
Other uncommon ones
	PEAPv0/v1 with EAP-SIM (Cisco)
Uses Server Side Certificates for validation
PEAP-EAP-TLS
	Additionally uses client side certificates or smart card
	Supported only by Microsoft

EAP-TTLS
EAP Tunneled Transport Layer Security
Server authenticates with certficaite
Client can optionally use Certificate as well
No native support on Windows
	- 3rd party utilities to be used
Versions
	-EAP-TTLSv0
	-EAP-TTLSv1

LEAP
Lightweight Extensible Authentication Protocol
Cisco proprietary
Almost obsolete now due to security issues - Dictionary attacks
	-Modified MSCHAP for authentication
Cisco recommends usage of EAP-FAST as official LEAP replacement.

EAP-FAST
Touted by Cisco as a replacement for LEAP
Server side certificates are optional
Uses Protected Access Credential (PAC) to create a TLS tunnel
	-Provisioning can be manual/automated per user
Credentials are exchanged over the TLS tunnel
Automatic PAC provisioning is susceptible to interception attack
A honeypot AP can be used by the attacker to send the PAC and then bruteforce the MSCHAPv2 credentials supplied by the client

PEAP Reloaded
PEAP is the most popular enterprise Wi-Fi security mechanism used
Full setup is done here in this using FreeRadius-WPE and a full authentication test
Will be exploring OSX and Windows

Demo :
In the default md5, change the protocol to PEAP
/usr/local/etc/raddb# vim eap.conf

Start radius server with peap configuration :
radiusd -s -X

Create a new profile to connect with the network :
Go to advanced in Airport.
Add New profile, Prompt for user name and password, enable only PEAP.
Choose the wireless network(eg.SecurityTube)
Connect to the network.

Now it will prompt for a password.
Provide the credentials.

wireshark &

ifconfig -a

airmon-ng start wlan0

iwconfig wlan0mon channel 1

This time monitor for wlan0mon.
wireshark &

In both the wireshark instances, monitor for eap packets.

The whole handshake process in the previous EAP structure happens.
