General integrity check value:

variable size 		CRC -32 	  32 bits
data			        -------->	  ICV

Then concatenate Data and ICV

ICV always remains 32 bits

----------------->--------------------------------------->------------------------------>---------------------
|								                                                                                             |	
^								                                                                                             |
|								                                                                                             |
24	    40/104		            =>      RC4		      =>                    Random Keystream	                   |
IV	    wep key		                  (KSA+PRGA)				                      |                                |
								                                                            |                                |
|		      |				                                                          |		                             V
------------                                                                |
     |       							                                                  V                               IV
64 bit or 128 bit WEP			                                                -----		                          +
			                                                                    |XOR|	        =>	            Cipher text
					                                                                -----
						                                                                ^
						                                                                |
					                                                              ----------	
					                                                              |Data|ICV|
					                                                              ----------


Wireshark a live capture and avoid beacon packets and look at QoS packets only

Look at IEEE 802.11 QoS data and Look at Data

Key Index: 0 (Cipher starts at initialization)

WEP ICV : 0x123abc ( displayed separately )

Go frame control, look at flags, Protected flag : 1
Flag set for any encryption.

WEP Decryption :

Decryption is the reverse of encryption for WEP.

To know what's in the air.
Wireshark -> statistics -> WLAN Traffic

Go to Edit, Preferences, Select Protocol.

1) Select IEEE 802.11 
2) Give the key for your encryption in key1
3) Enable decryption and click ok.

Now all the encrypted packets will be decrypted in wireshark level.

Save the packets -> save as -> click on "displayed" packets -> 'wep-encrypted' as name.

```
airdecap-ng -w ab:cd:ef:ab:cd wep-encrypted

wireshark wep-decrypted-dec 
```

We will have the decrypted packets.
